"use strict";(self.webpackChunkbooking_app=self.webpackChunkbooking_app||[]).push([[4408],{6428:(gt,f,r)=>{r.r(f),r.d(f,{ProprietorApplicationModule:()=>ut});var C=r(4006),m=r(5412),u=r(7392),g=r(8255),d=r(7974),c=r(671),_=r(6895),Z=r(9299),x=r(3900),y=r(262),b=r(5673),T=r(727),t=r(4650),A=r(7009),P=r(1820),v=r(9083),h=r(4859);function w(e,o){1&e&&(t.TgZ(0,"th",19),t._uU(1,"Cover Photo"),t.qZA())}function M(e,o){if(1&e&&t._UZ(0,"img",24),2&e){const n=t.oxw().$implicit;t.Q6J("src",n.cover,t.LSH)}}function U(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1,"No cover yet"),t.qZA())}function L(e,o){if(1&e&&(t.TgZ(0,"td",20)(1,"div",21),t.YNc(2,M,1,1,"img",22),t.qZA(),t.YNc(3,U,2,0,"div",23),t.qZA()),2&e){const n=o.$implicit;t.xp6(2),t.Q6J("ngIf",""!==n.cover),t.xp6(1),t.Q6J("ngIf",""===n.cover)}}function N(e,o){1&e&&(t.TgZ(0,"th",19),t._uU(1,"Name"),t.qZA())}function O(e,o){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.name," ")}}function Y(e,o){1&e&&(t.TgZ(0,"th",19),t._uU(1,"Type"),t.qZA())}function D(e,o){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.type," ")}}function Q(e,o){1&e&&(t.TgZ(0,"th",19),t._uU(1,"Description Filter"),t.qZA())}function I(e,o){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.desc," ")}}function S(e,o){1&e&&(t.TgZ(0,"th",19),t._uU(1,"Approved"),t.qZA())}function k(e,o){if(1&e&&(t.TgZ(0,"td",20),t._UZ(1,"mat-icon",25),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.Q6J("fontIcon",n.isApproved?"check_circle":"close")}}function H(e,o){1&e&&(t.TgZ(0,"th",19),t._uU(1,"Listed"),t.qZA())}function J(e,o){if(1&e&&(t.TgZ(0,"td",20),t._UZ(1,"mat-icon",25),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.Q6J("fontIcon",n.isListed?"check_circle":"close")}}function q(e,o){1&e&&t._UZ(0,"th",19)}function B(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"td",20)(1,"button",26),t.NdJ("click",function(){const s=t.CHM(n).$implicit,p=t.oxw();return t.KtG(p.openListing(s.id))}),t.TgZ(2,"mat-icon"),t._uU(3,"more_horiz"),t.qZA()()()}}function z(e,o){1&e&&t._UZ(0,"tr",27)}function R(e,o){1&e&&t._UZ(0,"tr",28)}const $=function(){return[5,10,25]};let F=(()=>{class e{constructor(n,a,i,s,p,l){this._staycation=n,this._md=a,this._mdRef=i,this.userId=s,this._changeDetector=p,this._basicUtil=l,this._snack=(0,t.f3M)(A.ux),this.total=0,this.listings=[],this.displayedColumns=["cover","name","placeType","desc","approved","listed","action"],this._sub=new T.w0}ngOnInit(){}ngAfterViewInit(){this._getHostList(this.paginator.pageIndex+1,this.paginator.pageSize),this._changeDetector.detectChanges()}ngOnDestroy(){this._sub.unsubscribe()}handlePageSizeLimit(n){this._getHostList(n.pageIndex+1,n.pageSize)}openListing(n){this._md.open(b.$,{width:"80%",height:"90vh",data:n,disableClose:!0}).afterClosed().subscribe(i=>{if(i){let s=this.listings.findIndex(p=>i.id===p.id);this.listings[s]={...this.listings[0],cover:this._basicUtil.setImgUrl(i.cover),isListed:i.isListed,isApproved:i.isApproved},this.dataSource=new c.by(this.listings),this.dataSource.paginator=this.paginator}})}_getHostList(n,a){this.listings=[],this._sub.add(this._staycation.getHostListing(this.userId,n,a).subscribe({next:i=>{this.total=i.total,i.listings.forEach(s=>{this.listings.push({id:s._id,host:s.host,cover:""!==s.cover?this._basicUtil.setImgUrl(s.cover):s.cover,name:s.name,type:s.placeType,desc:s.descriptionFilter,isApproved:s.isApproved,isListed:s.isListed})}),this.dataSource=new c.by(this.listings),this.dataSource.paginator=this.paginator},error:i=>{this._snack.open(i.error.code,"",{duration:1e3})}}))}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(P.x),t.Y36(m.uw),t.Y36(m.so),t.Y36(m.WI),t.Y36(t.sBO),t.Y36(v.M))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-listings"]],viewQuery:function(a,i){if(1&a&&t.Gf(d.NW,5),2&a){let s;t.iGM(s=t.CRH())&&(i.paginator=s.first)}},decls:32,vars:6,consts:[[1,"listing-container"],[1,"login-container-wrapper"],[1,"close-button","close"],["aria-hidden","false","aria-label","close","fontIcon","close","mat-dialog-close",""],[1,"title"],["mat-table","",3,"dataSource"],["matColumnDef","cover"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","placeType"],["matColumnDef","desc"],["matColumnDef","approved"],["matColumnDef","listed"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"length","pageSizeOptions","page"],["paginator",""],["mat-header-cell",""],["mat-cell",""],[1,"custom-property"],[3,"src",4,"ngIf"],[4,"ngIf"],[3,"src"],[3,"fontIcon"],["mat-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(a,i){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"mat-icon",3),t.qZA(),t.TgZ(4,"div",4),t._uU(5,"Host Listings"),t.qZA(),t.TgZ(6,"table",5),t.ynx(7,6),t.YNc(8,w,2,0,"th",7),t.YNc(9,L,4,2,"td",8),t.BQk(),t.ynx(10,9),t.YNc(11,N,2,0,"th",7),t.YNc(12,O,2,1,"td",8),t.BQk(),t.ynx(13,10),t.YNc(14,Y,2,0,"th",7),t.YNc(15,D,2,1,"td",8),t.BQk(),t.ynx(16,11),t.YNc(17,Q,2,0,"th",7),t.YNc(18,I,2,1,"td",8),t.BQk(),t.ynx(19,12),t.YNc(20,S,2,0,"th",7),t.YNc(21,k,2,1,"td",8),t.BQk(),t.ynx(22,13),t.YNc(23,H,2,0,"th",7),t.YNc(24,J,2,1,"td",8),t.BQk(),t.ynx(25,14),t.YNc(26,q,1,0,"th",7),t.YNc(27,B,4,0,"td",8),t.BQk(),t.YNc(28,z,1,0,"tr",15),t.YNc(29,R,1,0,"tr",16),t.qZA(),t.TgZ(30,"mat-paginator",17,18),t.NdJ("page",function(p){return i.handlePageSizeLimit(p)}),t.qZA()()()),2&a&&(t.xp6(6),t.Q6J("dataSource",i.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("length",i.total)("pageSizeOptions",t.DdM(5,$)))},dependencies:[_.O5,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,d.NW,h.lW,u.Hw,m.ZT],styles:[".listing-container[_ngcontent-%COMP%]{background-color:#fff;padding:2em;position:relative}.listing-container-wrapper[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin:0;padding:0}.listing-container-wrapper[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:Poppins-Medium;font-size:18px;color:#63ab68;margin-bottom:2rem;text-align:center}.listing-container-wrapper[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{overflow-y:auto}.custom-property[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin:.3rem 0}.custom-property[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;object-fit:fill;border:1px solid #a0a0a0;border-radius:2px}"]})}return e})();var V=r(7893);let G=(()=>{class e{constructor(n){this.dialogRef=n}closeValidation(){this.dialogRef.close()}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(m.so))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-validation-modal"]],decls:19,vars:0,consts:[[1,"more-info"],[1,"header"],[1,"title"],[1,"close-button-normal",3,"click"],[1,"content"],[1,"name_info"],[1,"footer"],[1,"main-button","custom_btn",3,"click"],[1,"main-button"]],template:function(a,i){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3," Admin "),t.qZA(),t.TgZ(4,"div",3),t.NdJ("click",function(){return i.closeValidation()}),t.TgZ(5,"mat-icon"),t._uU(6,"close"),t.qZA()()(),t._UZ(7,"hr"),t.TgZ(8,"div",4)(9,"div",5),t._uU(10," Admin Name "),t.qZA(),t.TgZ(11,"div",2),t._uU(12,"Are you sure you want to delete this account?"),t.qZA()(),t._UZ(13,"hr"),t.TgZ(14,"div",6)(15,"button",7),t.NdJ("click",function(){return i.closeValidation()}),t._uU(16,"Cancel"),t.qZA(),t.TgZ(17,"button",8),t._uU(18,"Delete"),t.qZA()()())},dependencies:[u.Hw],styles:[".more-info[_ngcontent-%COMP%]{font-family:Poppins-Regular!important;background-color:#fff;border-top-right-radius:5px;border-top-left-radius:5px;display:flex;flex-direction:column;height:100%}.more-info[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{flex:0;display:flex;width:100%;align-items:center;padding:.5rem 1rem;justify-content:space-between}.more-info[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700}.more-info[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{flex:1;display:grid;place-items:center;text-align:center;height:100%}.more-info[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:clamp(1rem,1.2vw,4rem);line-height:1.7vw}.more-info[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{padding:1rem 0;flex:0;display:flex;justify-content:center;gap:1rem}.more-info[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .custom_btn[_ngcontent-%COMP%]{background-color:#fff;border:2px solid #68A968;color:#68a968}"]})}return e})();var j=r(3071),W=r(7556);function K(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Profile"),t.qZA())}function X(e,o){if(1&e&&(t.TgZ(0,"td",13),t._UZ(1,"img",14),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.Q6J("src",n.profile,t.LSH)}}function E(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Firstname"),t.qZA())}function tt(e,o){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.Oqu(n.firstname)}}function et(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Lastname"),t.qZA())}function nt(e,o){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.Oqu(n.lastname)}}function it(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Status"),t.qZA())}function ot(e,o){if(1&e&&(t.TgZ(0,"td",13),t._UZ(1,"mat-icon",15),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.Q6J("fontIcon",n.approved?"check_circle":"close")}}function at(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Action"),t.qZA())}function st(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(n);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.handleSetAsHost(i.userId,i.staycationId,i.propAppId))}),t._uU(1," Give Proprietor Privileges "),t.qZA()}}function ct(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"td",13)(1,"button",16)(2,"mat-icon"),t._uU(3,"more_horiz"),t.qZA()(),t.TgZ(4,"mat-menu",null,17)(6,"button",18),t.NdJ("click",function(){const s=t.CHM(n).$implicit,p=t.oxw();return t.KtG(p.viewProfile(s.id))}),t._uU(7,"View"),t.qZA(),t.YNc(8,st,2,0,"button",19),t.TgZ(9,"button",18),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.openValidationModal("delete"))}),t._uU(10," Decline "),t.qZA()()()}if(2&e){const n=o.$implicit,a=t.MAs(5);t.xp6(1),t.Q6J("matMenuTriggerFor",a),t.xp6(7),t.Q6J("ngIf",!n.approved)}}function rt(e,o){1&e&&t._UZ(0,"tr",20)}function pt(e,o){1&e&&t._UZ(0,"tr",21)}const lt=function(){return[5,10,25]},mt=[{path:"",component:(()=>{class e{constructor(n,a,i,s,p,l){this._md=n,this._user=a,this._basicUtil=i,this._changeDetector=s,this.dialog=p,this._auth=l,this.total=0,this.appList=[],this.displayedColumns=["profile","firstname","lastname","approved","action"],this.validationText=[{suspend:"Are you sure you want to suspend this account?"},{delete:"Are you sure you want to delete this account?"},{logout:"Are you sure you want to logout this account?"}],this._sub=new T.w0}ngOnInit(){}ngAfterViewInit(){this._getApps(this.paginator.pageIndex+1,this.paginator.pageSize),this.dataSource.paginator=this.paginator,this._changeDetector.detectChanges()}ngOnDestroy(){this._sub.unsubscribe()}handlePageChange(n){this._getApps(n.pageIndex+1,n.pageSize)}viewListings(n){this._md.open(F,{width:"65%",height:"70%",data:n,disableClose:!0})}handleSetAsHost(n,a,i){this._sub.add(this._auth.csrfToken().pipe((0,x.w)(s=>this._user.setAsHost(n,a,i,s.token)),(0,y.K)(s=>s)).subscribe({next:s=>{this._getApps(this.paginator.pageIndex+1,this.paginator.pageSize)}}))}_getApps(n,a){this.appList=[],this.dataSource=new c.by,this._sub.add(this._user.getProprietorApplications(n,a).subscribe({next:i=>{let{total:s,list:p}=i;this.total=s,p.forEach(l=>{this.appList.push({id:l.user._id,profile:this._basicUtil.setImgUrl(l.user.img),firstname:l.user.name.fName,lastname:l.user.name.lName,approved:"pending"!==l.status,userId:l.user._id,propAppId:l._id})}),this.dataSource=new c.by(this.appList)}}))}viewProfile(n){this.dialog.open(V.W,{disableClose:!0,panelClass:"custom-view-profile-dialog",data:n})}openValidationModal(n){this.dialog.open(G,{width:"100%",height:"100%",maxHeight:"15rem",maxWidth:"30rem",data:{data:this.validationText,label:n}})}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(m.uw),t.Y36(j.K),t.Y36(v.M),t.Y36(t.sBO),t.Y36(m.uw),t.Y36(W.e))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-proprietor-application"]],viewQuery:function(a,i){if(1&a&&t.Gf(d.NW,5),2&a){let s;t.iGM(s=t.CRH())&&(i.paginator=s.first)}},decls:22,vars:6,consts:[["mat-table","",3,"dataSource"],["matColumnDef","profile"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","firstname"],["matColumnDef","lastname"],["matColumnDef","approved"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","select page","showFirstLastButtons","",1,"table-pagination",3,"length","pageSizeOptions","page"],["paginator",""],["mat-header-cell",""],["mat-cell",""],["alt","image",1,"img-listing",3,"src"],[3,"fontIcon"],["mat-button","",1,"action-btn",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-header-row",""],["mat-row",""]],template:function(a,i){1&a&&(t.TgZ(0,"h2"),t._uU(1,"Host Applications"),t.qZA(),t.TgZ(2,"table",0),t.ynx(3,1),t.YNc(4,K,2,0,"th",2),t.YNc(5,X,2,1,"td",3),t.BQk(),t.ynx(6,4),t.YNc(7,E,2,0,"th",2),t.YNc(8,tt,2,1,"td",3),t.BQk(),t.ynx(9,5),t.YNc(10,et,2,0,"th",2),t.YNc(11,nt,2,1,"td",3),t.BQk(),t.ynx(12,6),t.YNc(13,it,2,0,"th",2),t.YNc(14,ot,2,1,"td",3),t.BQk(),t.ynx(15,7),t.YNc(16,at,2,0,"th",2),t.YNc(17,ct,11,2,"td",3),t.BQk(),t.YNc(18,rt,1,0,"tr",8),t.YNc(19,pt,1,0,"tr",9),t.qZA(),t.TgZ(20,"mat-paginator",10,11),t.NdJ("page",function(p){return i.handlePageChange(p)}),t.qZA()),2&a&&(t.xp6(2),t.Q6J("dataSource",i.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("length",i.total)("pageSizeOptions",t.DdM(5,lt)))},dependencies:[_.O5,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,d.NW,h.lW,g.VK,g.OP,g.p6,u.Hw],styles:["table[_ngcontent-%COMP%]{overflow-y:auto}.img-listing[_ngcontent-%COMP%]{width:2.5rem;height:auto;padding:5px;border-radius:100%}.action-btn[_ngcontent-%COMP%]{border:none;background-color:transparent;outline:none;cursor:pointer}.table-pagination[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}"]})}return e})()}];let dt=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[Z.Bz.forChild(mt),Z.Bz]})}return e})(),ut=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[_.ez,dt,c.p0,d.TU,h.ot,g.Tx,u.Ps,m.Is,C.u5,C.UX,A.ZX]})}return e})()}}]);