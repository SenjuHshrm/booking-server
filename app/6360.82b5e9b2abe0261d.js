"use strict";(self.webpackChunkbooking_app=self.webpackChunkbooking_app||[]).push([[6360],{6360:(ot,x,r)=>{r.r(x),r.d(x,{ReportModule:()=>E});var g=r(6895),O=r(9299),t=r(4650),h=r(7974),c=r(671),T=r(727),l=r(5412),_=r(9083),d=r(7392);let b=(()=>{class e{constructor(n,i,o){this.dialogRef=n,this.data=i,this._util=o}handleClose(){this.dialogRef.close()}fullName(n){return this._util.constructName(n)}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(l.so),t.Y36(l.WI),t.Y36(_.M))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-view-report"]],decls:22,vars:3,consts:[[1,"report-modal"],[1,"report-close-btn",3,"click"],[1,"report-content"],[1,"input-wrapper"],[1,"label"],[1,"value"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"mat-icon",1),t.NdJ("click",function(){return o.handleClose()}),t._uU(2,"close"),t.qZA(),t.TgZ(3,"h2"),t._uU(4,"View Report"),t.qZA(),t._UZ(5,"hr"),t.TgZ(6,"div",2)(7,"div",3)(8,"div",4),t._uU(9,"Reporter:"),t.qZA(),t.TgZ(10,"div",5),t._uU(11),t.qZA()(),t.TgZ(12,"div",3)(13,"div",4),t._uU(14,"Reported:"),t.qZA(),t.TgZ(15,"div",5),t._uU(16),t.qZA()(),t.TgZ(17,"div",3)(18,"div",4),t._uU(19,"Message:"),t.qZA(),t.TgZ(20,"div",5),t._uU(21),t.qZA()()()()),2&i&&(t.xp6(11),t.Oqu(o.fullName(o.data.reporterInfo[0].name)),t.xp6(5),t.Oqu(o.fullName(o.data.reportedInfo[0].name)),t.xp6(5),t.Oqu(o.data.msg))},dependencies:[d.Hw],styles:[".report-modal[_ngcontent-%COMP%]{position:relative;padding:1rem 2rem}.report-modal[_ngcontent-%COMP%]   .report-close-btn[_ngcontent-%COMP%]{position:absolute;top:15px;right:2rem;cursor:pointer}.report-modal[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:0}.report-modal[_ngcontent-%COMP%]   .report-content[_ngcontent-%COMP%]{margin:.75rem 0 .5rem}.report-modal[_ngcontent-%COMP%]   .report-content[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:flex-start;flex-wrap:wrap}.report-modal[_ngcontent-%COMP%]   .report-content[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:1rem;font-weight:700}.report-modal[_ngcontent-%COMP%]   .report-content[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{margin:.5rem 1rem}"]})}return e})();var P=r(3900),v=r(262),A=r(2843),f=r(7009),w=r(2820),R=r(7556),C=r(1572),Z=r(4859);function y(e,s){1&e&&(t.TgZ(0,"span"),t._UZ(1,"mat-spinner",10),t.qZA()),2&e&&(t.xp6(1),t.Q6J("diameter",20))}function N(e,s){1&e&&(t.TgZ(0,"span"),t._uU(1,"Proceed"),t.qZA())}let U=(()=>{class e{constructor(n,i,o,a,p){this.dialogRef=n,this.data=i,this._util=o,this._report=a,this._auth=p,this.isLoading=!1,this.subscription=new T.w0,this._snack=(0,t.f3M)(f.ux)}handleClose(n,i){if(this.isLoading)return;let o={success:n};i&&(o.type=i,o.data=this.data),this.dialogRef.close(o)}fullName(n){return this._util.constructName(n)}handleGiveAction(){this.isLoading=!0,this.subscription.add(this._auth.csrfToken().pipe((0,P.w)(n=>this._report.setActions(this.data._id,this.data.type,n.token)),(0,v.K)(n=>(0,A._)(()=>n))).subscribe({next:n=>{this.isLoading=!1,this.handleClose(!0,this.data.type)},error:n=>{this.isLoading=!1,this._snack.open(n.error.code,"",{duration:1e3})}}))}get modalTitle(){return"suspend"===this.data.type?"Suspend":"terminate"===this.data.type?"Terminate":"Warning"}get actionName(){return"suspend"===this.data.type?"suspend":"terminate"===this.data.type?"terminate":"warn"}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(l.so),t.Y36(l.WI),t.Y36(_.M),t.Y36(w.r),t.Y36(R.e))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-action-report"]],decls:21,vars:7,consts:[[1,"report-modal"],[1,"report-close-btn",3,"click"],[1,"report-content"],[1,"input-wrapper",2,"margin-bottom","0.5rem"],[1,"label"],[1,"value"],[1,"button-wrapper",2,"margin-top","0.5rem"],["type","button","mat-raised-button","",3,"disabled","click"],[4,"ngIf"],["type","button","mat-raised-button","",1,"btn-danger",3,"disabled","click"],[3,"diameter"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"mat-icon",1),t.NdJ("click",function(){return o.handleClose(!1)}),t._uU(2,"close"),t.qZA(),t.TgZ(3,"h2"),t._uU(4),t.qZA(),t._UZ(5,"hr"),t.TgZ(6,"div",2)(7,"h3"),t._uU(8),t.qZA(),t.TgZ(9,"div",3)(10,"div",4),t._uU(11,"Reported:"),t.qZA(),t.TgZ(12,"div",5),t._uU(13),t.qZA()(),t._UZ(14,"hr"),t.TgZ(15,"div",6)(16,"button",7),t.NdJ("click",function(){return o.handleGiveAction()}),t.YNc(17,y,2,1,"span",8),t.YNc(18,N,2,0,"span",8),t.qZA(),t.TgZ(19,"button",9),t.NdJ("click",function(){return o.handleClose(!1)}),t._uU(20," Cancel "),t.qZA()()()()),2&i&&(t.xp6(4),t.hij("",o.modalTitle," Action"),t.xp6(4),t.hij("Are you sure you want to ",o.actionName," this host?"),t.xp6(5),t.Oqu(o.fullName(o.data.reportedInfo[0].name)),t.xp6(3),t.Q6J("disabled",o.isLoading),t.xp6(1),t.Q6J("ngIf",o.isLoading),t.xp6(1),t.Q6J("ngIf",!o.isLoading),t.xp6(1),t.Q6J("disabled",o.isLoading))},dependencies:[g.O5,d.Hw,C.Ou,Z.lW],styles:[".report-modal[_ngcontent-%COMP%]{position:relative;padding:1rem 2rem}.report-modal[_ngcontent-%COMP%]   .report-close-btn[_ngcontent-%COMP%]{position:absolute;top:15px;right:2rem;cursor:pointer}.report-modal[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:0}.report-modal[_ngcontent-%COMP%]   .report-content[_ngcontent-%COMP%]{margin:.5rem 0}.report-modal[_ngcontent-%COMP%]   .report-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.report-modal[_ngcontent-%COMP%]   .report-content[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:flex-start;flex-wrap:wrap}.report-modal[_ngcontent-%COMP%]   .report-content[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{margin:0 .5rem;font-weight:700}.report-modal[_ngcontent-%COMP%]   .report-content[_ngcontent-%COMP%]   .button-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:.5rem}.report-modal[_ngcontent-%COMP%]   .report-content[_ngcontent-%COMP%]   .button-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#68a968;color:#fff;gap:.3rem;padding:0 2rem;letter-spacing:.1rem}.report-modal[_ngcontent-%COMP%]   .report-content[_ngcontent-%COMP%]   .button-wrapper[_ngcontent-%COMP%]   .btn-danger[_ngcontent-%COMP%]{background-color:#f36666}"]})}return e})();var m=r(8255);function Y(e,s){1&e&&(t.TgZ(0,"th",16),t._uU(1,"Reporter"),t.qZA())}function k(e,s){if(1&e&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&e){const n=s.$implicit,i=t.oxw();t.xp6(1),t.hij(" ",i.fullName(n.reporterInfo[0].name)," ")}}function q(e,s){1&e&&(t.TgZ(0,"th",16),t._uU(1,"Reported"),t.qZA())}function J(e,s){if(1&e&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&e){const n=s.$implicit,i=t.oxw();t.xp6(1),t.hij(" ",i.fullName(n.reportedInfo[0].name)," ")}}function Q(e,s){1&e&&(t.TgZ(0,"th",16),t._uU(1,"Message"),t.qZA())}function S(e,s){if(1&e&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&e){const n=s.$implicit;t.xp6(1),t.Oqu(n.msg)}}function I(e,s){1&e&&(t.TgZ(0,"th",16),t._uU(1,"Action Taken"),t.qZA())}function D(e,s){if(1&e&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&e){const n=s.$implicit,i=t.oxw();t.xp6(1),t.Oqu(i.setAction(n.action))}}function L(e,s){1&e&&(t.TgZ(0,"th",16),t._uU(1,"Action"),t.qZA())}function j(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"td",17)(1,"button",18)(2,"mat-icon"),t._uU(3,"more_horiz"),t.qZA()(),t.TgZ(4,"mat-menu",null,19)(6,"button",20),t.NdJ("click",function(){const a=t.CHM(n).$implicit,p=t.oxw();return t.KtG(p.handleViewReport(a))}),t._uU(7,"View"),t.qZA(),t.TgZ(8,"button",20),t.NdJ("click",function(){const a=t.CHM(n).$implicit,p=t.oxw();return t.KtG(p.handleAction(a,"warning"))}),t._uU(9," Warning "),t.qZA(),t.TgZ(10,"button",20),t.NdJ("click",function(){const a=t.CHM(n).$implicit,p=t.oxw();return t.KtG(p.handleAction(a,"terminate"))}),t._uU(11," Terminate "),t.qZA(),t.TgZ(12,"button",20),t.NdJ("click",function(){const a=t.CHM(n).$implicit,p=t.oxw();return t.KtG(p.handleAction(a,"suspend"))}),t._uU(13," Suspend "),t.qZA()()()}if(2&e){const n=t.MAs(5);t.xp6(1),t.Q6J("matMenuTriggerFor",n)}}function z(e,s){1&e&&t._UZ(0,"tr",21)}function B(e,s){1&e&&t._UZ(0,"tr",22)}function H(e,s){1&e&&(t.TgZ(0,"span"),t._uU(1,"No Report Found"),t.qZA())}function W(e,s){1&e&&(t.TgZ(0,"span",27),t._UZ(1,"mat-spinner",28),t._uU(2," Loading data..."),t.qZA()),2&e&&(t.xp6(1),t.Q6J("diameter",15))}function F(e,s){if(1&e&&(t.TgZ(0,"tr",23)(1,"td",24),t.YNc(2,H,2,0,"span",25),t.YNc(3,W,3,1,"span",26),t.qZA()()),2&e){const n=t.oxw();t.xp6(2),t.Q6J("ngIf",!n.isLoading),t.xp6(1),t.Q6J("ngIf",n.isLoading)}}const G=function(){return[5,10,25]},V=[{path:"",component:(()=>{class e{constructor(n,i,o,a){this._changeDetector=n,this._report=i,this._util=o,this._dialog=a,this._snack=(0,t.f3M)(f.ux),this.dataSource=new c.by([]),this.displayedColumns=["reporter","reported","message","action-given","action"],this.subscription=new T.w0,this.isLoading=!1,this.total=0}ngOnInit(){this.dataSource.paginator=this.paginator}ngAfterViewInit(){this.getReports(this.paginator.pageSize,this.paginator.pageIndex+1),this.dataSource.paginator=this.paginator,this._changeDetector.detectChanges()}getReports(n,i){this.dataSource=new c.by([]),this.isLoading=!0,this.subscription.add(this._report.getReports(n,i).subscribe({next:o=>{this.dataSource=new c.by(o[0].paginatedResults),this.total=o[0].totalCount[0].count,this.isLoading=!1},error:o=>{this.isLoading=!1,this._snack.open(o.error.code,"",{duration:1e3})}}))}handlePageChange(n){this.getReports(n.pageSize,n.pageIndex+1)}handleViewReport(n){this._dialog.open(b,{disableClose:!0,maxWidth:"40rem",width:"90%",data:n})}handleAction(n,i){this._dialog.open(U,{disableClose:!0,maxWidth:"40rem",width:"90%",data:{...n,type:i}}).afterClosed().subscribe(a=>{const{success:p,type:tt,data:et}=a;if(p){const u=this.dataSource.data,M=u.findIndex(nt=>nt._id===et._id);-1!==M&&(u[M]={...u[M],action:tt},this.dataSource.data=[...u])}})}fullName(n){return this._util.constructName(n)}setAction(n){return"no-action"===n?"No Action":"warning"===n?"Warning":"suspend"===n?"Suspended":"Terminated"}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(t.sBO),t.Y36(w.r),t.Y36(_.M),t.Y36(l.uw))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-report"]],viewQuery:function(i,o){if(1&i&&t.Gf(h.NW,5),2&i){let a;t.iGM(a=t.CRH())&&(o.paginator=a.first)}},decls:26,vars:7,consts:[[1,"listing-search","card"],[1,"icon"],["type","text","name","search-listing","placeholder","Search listing","value",""],["mat-table","",3,"dataSource"],["matColumnDef","reporter"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","reported"],["matColumnDef","message"],["matColumnDef","action-given"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","select page","showFirstLastButtons","",1,"table-pagination",3,"disabled","length","pageSizeOptions","page"],["paginator",""],["mat-header-cell",""],["mat-cell",""],["mat-button","",1,"action-btn",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell","td-no-value"],[4,"ngIf"],["style","\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          gap: 0.5rem;\n        ",4,"ngIf"],[2,"display","flex","align-items","center","justify-content","center","gap","0.5rem"],[3,"diameter"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-icon"),t._uU(3,"search"),t.qZA()(),t._UZ(4,"input",2),t.qZA(),t.TgZ(5,"table",3),t.ynx(6,4),t.YNc(7,Y,2,0,"th",5),t.YNc(8,k,2,1,"td",6),t.BQk(),t.ynx(9,7),t.YNc(10,q,2,0,"th",5),t.YNc(11,J,2,1,"td",6),t.BQk(),t.ynx(12,8),t.YNc(13,Q,2,0,"th",5),t.YNc(14,S,2,1,"td",6),t.BQk(),t.ynx(15,9),t.YNc(16,I,2,0,"th",5),t.YNc(17,D,2,1,"td",6),t.BQk(),t.ynx(18,10),t.YNc(19,L,2,0,"th",5),t.YNc(20,j,14,1,"td",6),t.BQk(),t.YNc(21,z,1,0,"tr",11),t.YNc(22,B,1,0,"tr",12),t.YNc(23,F,4,2,"tr",13),t.qZA(),t.TgZ(24,"mat-paginator",14,15),t.NdJ("page",function(p){return o.handlePageChange(p)}),t.qZA()),2&i&&(t.xp6(5),t.Q6J("dataSource",o.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(2),t.Q6J("disabled",o.isLoading)("length",o.total)("pageSizeOptions",t.DdM(6,G)))},dependencies:[g.O5,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,c.Ee,h.NW,d.Hw,m.VK,m.OP,m.p6,C.Ou,Z.lW],styles:[".listing-search[_ngcontent-%COMP%]{margin-top:1rem;background-color:#fff;box-shadow:1px 1px 5px #8887;border-radius:5px;display:flex;align-items:center;justify-content:space-between;width:100%;max-width:30rem;gap:.1rem}.listing-search[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:50px;width:20%;height:100%;display:flex;justify-content:center;align-items:center;color:#68a86a;cursor:pointer}.listing-search[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:30px;height:auto;width:auto}.listing-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;outline:none;background-color:transparent;height:100%;width:100%;font-size:1rem;padding:1rem}table[_ngcontent-%COMP%]{margin-top:1rem}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{max-width:12rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}table[_ngcontent-%COMP%]   td.td-no-value[_ngcontent-%COMP%]{padding:1rem 0;text-align:center}.img-listing[_ngcontent-%COMP%]{width:2.5rem;height:auto;padding:5px;border-radius:100%}.action-btn[_ngcontent-%COMP%]{border:none;background-color:transparent;outline:none;cursor:pointer}.table-pagination[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}"]})}return e})()}];let $=(()=>{class e{static#t=this.\u0275fac=function(i){return new(i||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[O.Bz.forChild(V),O.Bz]})}return e})();var K=r(4144),X=r(9549);let E=(()=>{class e{static#t=this.\u0275fac=function(i){return new(i||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[g.ez,$,c.p0,h.TU,K.c,X.lN,d.Ps,m.Tx,C.Cq,Z.ot,f.ZX]})}return e})()}}]);