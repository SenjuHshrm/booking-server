"use strict";(self.webpackChunkbooking_app=self.webpackChunkbooking_app||[]).push([[2002],{2002:(at,x,s)=>{s.r(x),s.d(x,{IdentificationModule:()=>it});var b=s(6895),T=s(9299),t=s(4650),I=s(4006),g=s(7974),l=s(671),M=s(727),d=s(5412),f=s(9083),p=s(7392);let y=(()=>{class n{constructor(e,i,o){this.dialogRef=e,this.data=i,this._util=o}handleClose(){this.dialogRef.close()}ngOnInit(){}get frontIdSrc(){return this._util.setImgUrl(this.data.idFront)}get backIdSrc(){return this._util.setImgUrl(this.data.idBack)}get fullName(){return this._util.constructName(this.data.userInfo[0].name)}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(d.so),t.Y36(d.WI),t.Y36(f.M))};static#n=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-view-verification"]],decls:27,vars:6,consts:[[1,"modal"],[1,"modal-close-btn",3,"click"],[1,"modal-content-container"],[1,"details"],[1,"label"],[1,"value"],[1,"images"],["draggable","false","loading","lazy",1,"image",3,"src","alt"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"mat-icon",1),t.NdJ("click",function(){return o.handleClose()}),t._uU(2,"close"),t.qZA(),t.TgZ(3,"h2"),t._uU(4,"View Verification"),t.qZA(),t._UZ(5,"hr"),t.TgZ(6,"div",2)(7,"div",3)(8,"div",4),t._uU(9,"Account Name:"),t.qZA(),t.TgZ(10,"div",5),t._uU(11),t.qZA()(),t.TgZ(12,"div",3)(13,"div",4),t._uU(14,"ID Type:"),t.qZA(),t.TgZ(15,"div",5),t._uU(16),t.qZA()(),t.TgZ(17,"div",6)(18,"div")(19,"div",4),t._uU(20,"ID Front Vew:"),t.qZA(),t._UZ(21,"img",7),t.qZA(),t.TgZ(22,"div")(23,"div",4),t._uU(24,"ID Back Vew:"),t.qZA(),t._UZ(25,"img",7),t.qZA()()(),t._UZ(26,"hr"),t.qZA()),2&i&&(t.xp6(11),t.Oqu(o.fullName),t.xp6(5),t.Oqu(o.data.type),t.xp6(5),t.s9C("src",o.frontIdSrc,t.LSH),t.s9C("alt",o.data.type),t.xp6(4),t.s9C("src",o.backIdSrc,t.LSH),t.s9C("alt",o.data.type))},dependencies:[p.Hw],styles:[".modal[_ngcontent-%COMP%]{position:relative;padding:1rem 2rem}.modal[_ngcontent-%COMP%]   .modal-close-btn[_ngcontent-%COMP%]{position:absolute;top:15px;right:2rem;cursor:pointer}.modal[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:0}.modal-content-container[_ngcontent-%COMP%]{margin-bottom:1rem}.modal-content-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:.5rem 0}.modal-content-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:700}.modal-content-container[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;gap:1rem}.modal-content-container[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{max-width:300px;max-height:240px;min-width:300px;min-height:240px;width:300px;height:240px;object-fit:cover;background-color:#d3d3d369;padding:1rem}"]})}return n})();var P=s(3900),U=s(262),w=s(2843),h=s(7009),O=s(3071),D=s(7556),_=s(4859),A=s(1572);function N(n,c){1&n&&(t.TgZ(0,"span"),t._UZ(1,"mat-spinner",10),t.qZA()),2&n&&(t.xp6(1),t.Q6J("diameter",20))}function S(n,c){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Oqu("approve"===e.data.action?"Approve":"Disapprove")}}let k=(()=>{class n{constructor(e,i,o,a,r){this.dialogRef=e,this.data=i,this._util=o,this._user=a,this._auth=r,this.isLoading=!1,this.subscription=new M.w0,this._snack=(0,t.f3M)(h.ux)}handleClose(e,i,o){if(this.isLoading)return;let a={success:e};i&&(a.data=i,a.status=o),this.dialogRef.close({result:a})}handleChangeStatus(){this.isLoading=!0;const e="approve"===this.data.action?"approved":"rejected";this.subscription.add(this._auth.csrfToken().pipe((0,P.w)(i=>this._user.updateVerificationStatus(e,this.data._id,i.token)),(0,U.K)(i=>(0,w._)(()=>i))).subscribe({next:i=>{this.isLoading=!1,this.handleClose(!0,this.data,e)},error:({error:i})=>{this.isLoading=!1,this._snack.open(i.msg||i.code||"Failed to change the status.","Ok")}}))}get frontIdSrc(){return this._util.setImgUrl(this.data.idFront)}get backIdSrc(){return this._util.setImgUrl(this.data.idBack)}get fullName(){return this._util.constructName(this.data.userInfo[0].name)}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(d.so),t.Y36(d.WI),t.Y36(f.M),t.Y36(O.K),t.Y36(D.e))};static#n=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-approve-disapprove"]],decls:26,vars:7,consts:[[1,"modal"],[1,"modal-close-btn",3,"click"],[1,"modal-content-container"],[1,"details"],[1,"label"],[1,"value"],[1,"btns"],["type","button","mat-raised-button","",3,"click"],[4,"ngIf"],["type","button","mat-raised-button","",1,"btn-danger",3,"disabled","click"],[3,"diameter"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"mat-icon",1),t.NdJ("click",function(){return o.handleClose(!1)}),t._uU(2,"close"),t.qZA(),t.TgZ(3,"h2"),t._uU(4),t.qZA(),t._UZ(5,"hr"),t.TgZ(6,"div",2)(7,"h3"),t._uU(8),t.qZA(),t.TgZ(9,"div",3)(10,"div",4),t._uU(11,"Account Name:"),t.qZA(),t.TgZ(12,"div",5),t._uU(13),t.qZA()(),t.TgZ(14,"div",3)(15,"div",4),t._uU(16,"ID Type:"),t.qZA(),t.TgZ(17,"div",5),t._uU(18),t.qZA()(),t._UZ(19,"hr"),t.TgZ(20,"div",6)(21,"button",7),t.NdJ("click",function(){return o.handleChangeStatus()}),t.YNc(22,N,2,1,"span",8),t.YNc(23,S,2,1,"span",8),t.qZA(),t.TgZ(24,"button",9),t.NdJ("click",function(){return o.handleClose(!1)}),t._uU(25," Cancel "),t.qZA()()()()),2&i&&(t.xp6(4),t.hij(" ","approve"===o.data.action?"Approve":"Disapprove"," Verification "),t.xp6(4),t.hij(" Are you sure want to ","approve"===o.data.action?"approve":"disapprove"," this account? "),t.xp6(5),t.Oqu(o.fullName),t.xp6(5),t.Oqu(o.data.type),t.xp6(4),t.Q6J("ngIf",o.isLoading),t.xp6(1),t.Q6J("ngIf",!o.isLoading),t.xp6(1),t.Q6J("disabled",o.isLoading))},dependencies:[b.O5,p.Hw,_.lW,A.Ou],styles:[".modal[_ngcontent-%COMP%]{position:relative;padding:1rem 2rem}.modal[_ngcontent-%COMP%]   .modal-close-btn[_ngcontent-%COMP%]{position:absolute;top:15px;right:2rem;cursor:pointer}.modal[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:0}.modal-content-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:500;margin:.5rem 0}.modal-content-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;margin:.5rem 0}.modal-content-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:700}.modal-content-container[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]{margin-top:.5rem;display:flex;align-items:center;justify-content:flex-end;gap:.5rem}.modal-content-container[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]   .btn-danger[_ngcontent-%COMP%]{background-color:#f36666}.modal-content-container[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#68a968;color:#fff;gap:.3rem;padding:0 2rem;letter-spacing:.1rem}"]})}return n})();var m=s(8255);function Y(n,c){1&n&&(t.TgZ(0,"th",18),t._uU(1,"Profile"),t.qZA())}const V=function(n){return[n]};function q(n,c){if(1&n&&(t.TgZ(0,"td",19),t._UZ(1,"img",20),t.qZA()),2&n){const e=c.$implicit,i=t.oxw();t.xp6(1),t.Q6J("src",t.VKq(1,V,i.imgSrc(e.userInfo[0].img)),t.LSH)}}function J(n,c){1&n&&(t.TgZ(0,"th",18),t._uU(1,"Firstname"),t.qZA())}function Q(n,c){if(1&n&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&n){const e=c.$implicit;t.xp6(1),t.hij(" ",e.userInfo[0].name.fName," ")}}function B(n,c){1&n&&(t.TgZ(0,"th",18),t._uU(1,"Lastname"),t.qZA())}function z(n,c){if(1&n&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&n){const e=c.$implicit;t.xp6(1),t.hij(" ",e.userInfo[0].name.lName," ")}}function j(n,c){1&n&&(t.TgZ(0,"th",18),t._uU(1,"Identification Type"),t.qZA())}function F(n,c){if(1&n&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&n){const e=c.$implicit;t.xp6(1),t.Oqu(e.type)}}function H(n,c){1&n&&(t.TgZ(0,"th",18),t._uU(1,"Status"),t.qZA())}function L(n,c){if(1&n&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&n){const e=c.$implicit;t.xp6(1),t.hij(" ",e.status," ")}}function R(n,c){1&n&&(t.TgZ(0,"th",18),t._uU(1,"Action"),t.qZA())}function K(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"td",19)(1,"button",22)(2,"mat-icon"),t._uU(3,"more_horiz"),t.qZA()(),t.TgZ(4,"mat-menu",null,23)(6,"button",24),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.handleViewVerification(a))}),t._uU(7," View "),t.qZA(),t.TgZ(8,"button",24),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.handleApproveDisapproveVerification("approve",a))}),t._uU(9," Approved "),t.qZA(),t.TgZ(10,"button",24),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.handleApproveDisapproveVerification("disapprove",a))}),t._uU(11," DisApproved "),t.qZA()()()}if(2&n){const e=t.MAs(5);t.xp6(1),t.Q6J("matMenuTriggerFor",e)}}function G(n,c){1&n&&t._UZ(0,"tr",25)}function W(n,c){1&n&&t._UZ(0,"tr",26)}const $=function(){return[5,10,25]},X=[{path:"",component:(()=>{class n{constructor(e,i,o,a){this._user=e,this._util=i,this._dialog=o,this._changeDetector=a,this._snack=(0,t.f3M)(h.ux),this.subscription=new M.w0,this.total=0,this.searchControl=new I.NI,this.dataSource=new l.by([]),this.displayedColumns=["profile","firstname","lastname","identification","status","action"],this.searchKey=""}ngOnInit(){}ngAfterViewInit(){this._getVerifications(this.paginator.pageSize,this.paginator.pageIndex+1),this.dataSource.paginator=this.paginator,this._changeDetector.detectChanges()}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}handlePageChange(e){this._getVerifications(e.pageSize,e.pageIndex+1)}_getVerifications(e,i,o){this.subscription.add(this._user.getVerificationList(i,e,o||"").subscribe({next:r=>{const{totalCount:C,paginatedResults:v}=r[0];this.total=C[0]?.count||0,this.dataSource=new l.by(v)},error:r=>{this._snack.open(r.error.code,"",{duration:1e3})}}))}imgSrc(e){return this._util.setImgUrl(e)}handleViewVerification(e){this._dialog.open(y,{disableClose:!0,data:e,panelClass:"custom-verification-modal",maxWidth:"50rem"})}handleApproveDisapproveVerification(e,i){this._dialog.open(k,{disableClose:!0,data:{...i,action:e},panelClass:"custom-verification-modal",maxWidth:"50rem"}).afterClosed().subscribe(a=>{const{success:r,data:C,status:v}=a.result;if(r){const u=this.dataSource.data,Z=u.findIndex(ot=>ot._id===C._id);-1!==Z&&(u[Z]={...u[Z],status:v},this.dataSource.data=[...u])}})}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(O.K),t.Y36(f.M),t.Y36(d.uw),t.Y36(t.sBO))};static#n=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-identification"]],viewQuery:function(i,o){if(1&i&&(t.Gf(g.NW,5),t.Gf(l.BZ,5)),2&i){let a;t.iGM(a=t.CRH())&&(o.paginator=a.first),t.iGM(a=t.CRH())&&(o.table=a.first)}},decls:30,vars:6,consts:[[1,"listing-search","card"],[1,"icon"],["type","text","name","search","placeholder","Search listing"],["type","submit",2,"display","none"],["mat-table","",3,"dataSource"],["matColumnDef","profile"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","firstname"],["matColumnDef","lastname"],["matColumnDef","identification"],["matColumnDef","status"],["mat-cell","","style","text-transform: capitalize",4,"matCellDef"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","select page","showFirstLastButtons","",1,"table-pagination",3,"length","pageSizeOptions","page"],["paginator",""],["mat-header-cell",""],["mat-cell",""],["alt","image",1,"img-listing",3,"src"],["mat-cell","",2,"text-transform","capitalize"],["mat-button","",1,"action-btn",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,o){1&i&&(t.TgZ(0,"form")(1,"div",0)(2,"div",1)(3,"mat-icon"),t._uU(4,"search"),t.qZA()(),t._UZ(5,"input",2)(6,"button",3),t.qZA()(),t.TgZ(7,"table",4),t.ynx(8,5),t.YNc(9,Y,2,0,"th",6),t.YNc(10,q,2,3,"td",7),t.BQk(),t.ynx(11,8),t.YNc(12,J,2,0,"th",6),t.YNc(13,Q,2,1,"td",7),t.BQk(),t.ynx(14,9),t.YNc(15,B,2,0,"th",6),t.YNc(16,z,2,1,"td",7),t.BQk(),t.ynx(17,10),t.YNc(18,j,2,0,"th",6),t.YNc(19,F,2,1,"td",7),t.BQk(),t.ynx(20,11),t.YNc(21,H,2,0,"th",6),t.YNc(22,L,2,1,"td",12),t.BQk(),t.ynx(23,13),t.YNc(24,R,2,0,"th",6),t.YNc(25,K,12,1,"td",7),t.BQk(),t.YNc(26,G,1,0,"tr",14),t.YNc(27,W,1,0,"tr",15),t.qZA(),t.TgZ(28,"mat-paginator",16,17),t.NdJ("page",function(r){return o.handlePageChange(r)}),t.qZA()),2&i&&(t.xp6(7),t.Q6J("dataSource",o.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(1),t.Q6J("length",o.total)("pageSizeOptions",t.DdM(5,$)))},dependencies:[l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,g.NW,p.Hw,m.VK,m.OP,m.p6,_.lW],styles:[".listing-search[_ngcontent-%COMP%]{margin-top:1rem;background-color:#fff;box-shadow:1px 1px 5px #8887;border-radius:5px;display:flex;align-items:center;justify-content:space-between;width:100%;max-width:30rem;gap:.1rem}.listing-search[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:50px;width:20%;height:100%;display:flex;justify-content:center;align-items:center;color:#68a86a;cursor:pointer}.listing-search[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:30px;height:auto;width:auto}.listing-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;outline:none;background-color:transparent;height:100%;width:100%;font-size:1rem;padding:1rem}table[_ngcontent-%COMP%]{margin-top:1rem}.img-listing[_ngcontent-%COMP%]{width:2.5rem;height:auto;padding:5px;border-radius:100%}.action-btn[_ngcontent-%COMP%]{border:none;background-color:transparent;outline:none;cursor:pointer}.table-pagination[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}"]})}return n})()}];let E=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#n=this.\u0275mod=t.oAB({type:n});static#e=this.\u0275inj=t.cJS({imports:[T.Bz.forChild(X),T.Bz]})}return n})();var tt=s(4144),nt=s(9549),et=s(3162);let it=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#n=this.\u0275mod=t.oAB({type:n});static#e=this.\u0275inj=t.cJS({imports:[b.ez,E,l.p0,g.TU,tt.c,nt.lN,p.Ps,m.Tx,_.ot,et.Cv,A.Cq,h.ZX]})}return n})()}}]);